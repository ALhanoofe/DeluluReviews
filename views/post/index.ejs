<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Posts</title>
    <link rel="stylesheet" href="/style/post.css" />
  </head>
  <body>
    <%- include('../partials/_navbar') %>
    <h1><%= category %></h1>
    <div class="main">
      
      <!-- Book -->
      <div class="posts-container">
        <% posts.forEach(post => { %> <% if (post.category === 'Books') { %>
        <div class="post-div">
          <%= console.log(post) %>
          <img
            src="/uploads/<%= post.image %>"
            alt="<%= post.name %>"
            width="150"
          />
          <h3>Name: <%= post.name %></h3>
          <h3>Author: <%= post.author %></h3>
          <h3>Rating: <%= post.rate %></h3>
          <p>Review: <%= post.review %></p>
<% if (post.postOwner && user && post.postOwner._id.equals(user._id)) { %>
          <div class="owner-container">
            <p>Owned by you</p>
            <a href="comment/<%= post._id %>" class="owner-container">view details</a>
            <a href="/post/<%= post._id %>/edit">Edit</a>
            <a href="/post/<%= post._id %>?_method=DELETE"><button type="submit">Delete Post</button></a>
        
          </div>
          <% } else { %>
          <p>Owned by <%= post.postOwner.username %></p>
        <a href="comment/<%= post._id %>" class="owner-container">view details</a>
          <% } %>
        </div>
        <% } %> <% }) %>
      </div>

      <!-- Dramas -->
      <div class="posts-container">
        <% posts.forEach(post => { %> <% if (post.category === 'Dramas') { %>
        <div class="post-div">
          <img
            src="../../uploads/<%= post.image %>"
            alt="<%= post.name %>"
            width="150"
          />
          <h3>Name: <%= post.name %></h3>
          <h3>Author: <%= post.author %></h3>
          <h3>Post Owner: <%= post.postOwner.username %></h3>
          <h3>Rating: <%= post.rate %></h3>
          <p>Review: <%= post.review %></p>
<% if (post.postOwner && user && post.postOwner._id.equals(user._id)) { %>
          <div class="owner-container">
            <p>Owned by you</p>
        <a href="comment/<%= post._id %>" class="owner-container">view details</a>
            <a href="/post/<%= post._id %>/edit">Edit</a>
                      <a href="/post/<%= post._id %>?_method=DELETE"><button type="submit">Delete Post</button></a>

          </div>
          <% } else { %>
          <p>Owned by <%= post.postOwner.username %></p>
        <a href="comment/<%= post._id %>" class="owner-container">view details</a>

          <% } %>
        </div>
        <% } %> <% }) %>
      </div>

        <!-- Movies -->
    <div class="posts-container">
        <% posts.forEach(post => { %> <% if (post.category === 'Movies') { %>
        <div class="post-div">
          <%= console.log(post) %>
          <img
            src="/uploads/<%= post.image %>"
            alt="<%= post.name %>"
            width="150"
          />
          <h3>Name: <%= post.name %></h3>
          <h3>Author: <%= post.author %></h3>
          <h3>Post Owner: <%= post.postOwner.username %></h3>
          <h3>Rating: <%= post.rate %></h3>
          <p>Review: <%= post.review %></p>
<% if (post.postOwner && user && post.postOwner._id.equals(user._id)) { %>
          <div class="owner-container">
            <p>Owned by you</p>
           <a href="comment/<%= post._id %>" class="owner-container">view details</a>
            <a href="/post/<%= post._id %>/edit">Edit</a>
            <a href="/post/<%= post._id %>?_method=DELETE"><button type="submit">Delete Post</button></a>
        
          </div>
          <% } else { %>
          <p>Owned by <%= post.postOwner.username %></p>
        <a href="comment/<%= post._id %>" class="owner-container">view details</a>
          <% } %>
        </div>
        <% } %> <% }) %>
      </div>
  </div>
  </body>
</html>
